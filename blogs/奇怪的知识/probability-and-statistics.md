---
title: 概率论与数理统计
date: 2023-04-26
tags:
    - 概率论
categories: 
    - 奇怪的知识
---

## 样本空间，随机事件

### 随机事件

* 可以在相同条件下重复进行。
* 事先知道所有可能出现的结果。
* 进行试验前并不知道哪个试验结果会发生。

### 样本空间

* 随机试验的所有可能结果构成的集合称为样本空间，记为 $S=\{e\}$, S 中的元素 e 称为**样本点**。
  * 抛硬币
    * $S=\{正面，反面\}$
  * 记录产品的使用寿命 
    * $S=\{x: x \geq 10\}$ 
  * 记录某一地一昼夜的最高温度 x, 最低温度 y 
    * $S=\{(x, y): a\leq y \leq x \leq b\}$

如果把 S 看作事件，则每次试验 S 总是发生，所以 S 称为**必然事件**。
如果事件只包含一个样本点，称其为**基本事件**。
如果事件是空集，里面不包含任何样本点，则称为**不可能事件**。

### 事件的相互关系及运算

* $A \subset B$
  * 事件 A 发生一定导致事件 B 发生。
* $A \cup B$
  * A 与 B 至少有一个发生。
* $A \cap B$，$A·B$ 或 $AB$
  * A 与 B 同时发生。
* 当 $AB=\phi$ 时，称事件 A 与 B 不相容或互斥。
* A 与 B 的差事件
  * $A-B=\{x | x \in A 且 x \notin B\}$
  * $A-B = A \bar B = A \cup B-B = A-AB$
* A 的逆事件，记为 $\bar A$，也称 A 的 互逆，对立事件。

### 事件的运算定律

* $A \cup B=B \cup A$
* $A \cap B=B \cap A$
* $A \cup (B \cup C)=(A \cup B)\cup C$
* $A \cap (B \cap C)=(A \cap B) \cap C$
* $A \cup (B \cap C)=(A \cup B)\cap(A \cup C)$
* $A \cap (B \cup C)=(A \cap B)\cup(A \cap C)$
* $\overline{A \cup B}$ = $\bar A \cap \bar B$
* $\overline{A \cap B}$ = $\bar A \cup \bar B$

## 频率和概率

### 频率定义

$f_n(A)= \dfrac{n_A}{n}$
其中 $n_A$ 是 A 发生的次数(频数)，n 是总试验次数。称 $f_n(A)$为 A 在这 n 次实验中发生的频率。

### 频率的性质
* $0 \leq f_n(A) \leq 1$
* $f_n(S)=1$
* 若 $A_1,A_2,,,A_k$ 两两互不相容，则 $$f_n(\cup_{i=1}^{k}A_i) = \sum_{i=1}^{k} f_n(A_i)$$
* $f_n(A)$随着 n 的增大而趋于稳定，稳定值为 p.

### 概率

#### 概率的统计性定义

当试验的次数增加时，随机事件 A 发生的频率的稳定值 p 称为概率，记为 $P(A)=p$

#### 概率的公理化定义

设随机试验对应的样本空间为 S, 对每个事件 A，定义 P(A) 满足
1. 非负性: $P(A) \geq 0$
2. 规范性: $P(S) = 1$
3. 可列可加性: $A_1,A_2,...$ 两两互斥，即 $A_iA_j=\phi, i \neq j$, 则 $$P(\cup_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty}P(A_i)$$

> 满足以上三个条件的，称 P(A) 为事件 A 的概率。

#### 性质

1. $P(\phi)=0$
2. $P(A)=1-P(\bar A)$
3. 有限可加性 $$A_1,A_2,...A_n,A_i,A_j = \phi, i \neq j，\Rightarrow P(\cup_{i=1}^nA_i)=\sum_{i=1}^{n}P(A_i)$$
4. 若 $A \subset B$，则有 $P(B-A)=P(B)-P(A)$
   1. 对一般情况：$P(B-A)=P(B)-P(AB)$
5. $P(A \cup B)=P(A)+P(B)-P(AB)$
   1. $P(A \cup B \cup C)=P(A)+P(B)+P(C)-P(AB)-P(AC)-P(BC)-P(ABC)$

::: tip
设甲，乙两人向同一目标进行射击，已知甲击中的概率为 0.7，乙击中的概率为 0.6，甲乙同时击中的概率为 0.4。
 
1. 目标没有被击中的概率
2. 甲击中目标，而乙未击中的概率

设 A={甲击中目标}，B={乙击中目标}，则 P{A}=0.7, P{B}=0.6, P{AB}=0.4
1. 目标没有被击中的概率 = $P(\bar A \bar B) = 1 - P(A \cup B) = 1 - [P(A)+P(B)-P(AB)] = 0.1$
2. 甲击中，乙未击中的概率 = $P(A \bar B) = P(A) - P(AB) = 0.3$
::: 

## 等可能概型（古典概型）

若试验满足
1. 样本空间 S 中样本点有限（有限性）
2. 出现每一个样本点的概率相等（等可能性）
称这种试验为等可能概型（或古典概型）

对于古典概型 $$P(A)=\dfrac{A所包含的样本点数}{S中的样本点数}$$

::: tip
一袋中有 5 个球，其中 3 个为白球，2 个为黄球，设取到每一球的可能性相等。
1. 从袋中随机取出一球，记 $A={取到白球}$，求 P(A)
2. 从袋中不放回取两球，记 $B={两个都是白球}$，球 P(B)

将球编号，白球为 1，2，3，黄球为 4，5
1. $S=\{1,2,3,4,5\}, A=\{1,2,3\} \Rightarrow P(A)=\dfrac{3}{5}$
2. $P(B)=\dfrac{C_{3}^{2}}{C_{5}^{2}}=0.3$
:::

一般地，如果有 N 个球，其中 a 个白球，b=N-a 个黄球，采用不放回抽样抽取 $n$ 个球（$n<=N$）
记 $A_{k}=\{恰好取到k个白球\}（k<=a）$,则 $$P(A_k)=\dfrac{C_{a}^{k}C_{n-k}{b}}{C_{N}^{n}}, 其中 C_{N}^{n}=\dfrac{N!}{n!(N-n)!}$$

::: tip
23 个人中，至少有两人生日相同的概率。

假设每个人的生日在一年 365 天是等可能的，所以 23 人生日共有 $365^{23}$ 种可能性。

考虑事件 A任何两人生日不同 $$ P(\bar{A})=1-P(A)=1-\dfrac{365\times 364\times...\times(365-23+1)}{365^{23}}\approx 0.507 $$
::: 

## 条件概率

$P(B|A)$ 表示在 A 发生的条件下，B 发生的条件概率。
$$P(B|A)=\dfrac{P(AB)}{P(A)}, P(A) > 0$$

条件概率也同样满足

$P(B|A) = 1 - P(\bar B|A)$ <br>
$P(B\cup C|A) = P(B|A) + P(C|A) - P(BC|A)$

### 乘法公式
当下面的条件概率都有意义时
* $P(AB)=P(A) \cdot P(B|A)=P(B) \cdot P(A|B)$
* $P(ABC)=P(A)\cdot P(B|A) \cdot P(C|AB)$
* $P(A_{1}A_{2}A_{3}...A_{n})=P(A_{1})P(A_{2}|A_{1})P(A_{3}|A_{1}A_{2})...P(A_{n}|A_{1}A_{2}...A{n-1})$

:::tip
$P(A)=1/4, P(B|A)=1/3, P(A|B)=1/2$<br>
求 $P(A\cup B), P(\bar A|A \cup B)$

---
$P(AB)=P(A)P(B|A)=1/12$

$P(B)=\dfrac{P(AB)}{P(A|B)}=1/6$

$P(A \cup B)=P(A)+P(B)-P(AB)=1/4+1/6-1/12=1/3$

---
$P(\bar A|A\cup B)=1-P(A|A\cup B)=1-\dfrac{P(A \cdot A\cup B)}{P(A\cup B)}=1-\dfrac{P(A)}{P(A \cup B)}=1- \dfrac{1/4}{1/3}=1/4$
:::

## 全概率公式与贝叶斯公式

### 划分
若
1. 不漏 $B_{1} \cup B_{2}...B_{n}=S$
2. 不重 $B_{i}B_{j}= \phi, i \neq j$

则称 $B_{1},B_{2},...B_{n}$ 为 S 的一个划分。

**定理**
设 $B_{1},B_{2},...B_{n}$ 为 S 的一个划分，且 $P(B_{i}) > 0$, 则有全概率公式 $$P(A)=\sum_{j=1}^{n} P(B_{j}) \cdot P(A|B_{j})$$

**定理**
设 $B_{1},B_{2},...B_{n}$ 为 S 的一个划分，且 $P(B_{i}) > 0$, 对 $P(A)>0$，有贝叶斯公式 $$P(B_{i}|A)=\frac{P(B_{i})P(A|B_{i})}{\sum_{j=1}^{n}P(B_{j})P(A|B_{i})}=\frac{p_{i}q_{i}}{\sum_{j=1}^{n}p_{j}q_{j}}$$

其中 $P(B_{i})$ 叫做**先验概率**，$P({B_{i}|A})$ 叫做**后验概率**。

:::tip
一小学举办家长开放日，欢迎家长参加活动，小明的母亲参加的概率为 80%，若母亲参加，则父亲参加的概率为 30%，若母亲不参加，则父亲参加的概率为 90%。
1. 求父母都参加的概率。
2. 求父亲参加的概率。
3. 在已知父亲参加的条件下，求母亲参加的概率。

设 $A=\{母亲参加\}$，$B=\{父亲参加\}$。则 $P(A)=0.8, P(B|A) = 0.3, P(B|\bar A)=0.9$
1. $P(AB) = P(A)P(B|A)=0.24$
2. 由全概率公式：$P(B) = P(A)P(B|A) + P(\bar A)P(B|\bar A) = 0.24+0.18 = 0.42$
3. $P(A|B) = \frac{P(AB)}{P(B)} = 4/7$
:::

:::tip
有甲乙两盒，甲盒中有 3 个红球和 2 个白球，乙盒有 2 个红球，1 个白球。先从甲盒中采用不放回抽样取 3 个球放入乙盒，再从乙盒中取 1 个球，求取到的是红球的概率。

1. 从甲盒中取出 3 个球都是红球的概率为 $\frac{C_{3}^{3}}{C_{5}^{3}}=1/10$
2. 从甲盒中取出 3 个球，其中 2 个红球，1 个白球的概率为 $\frac{C_{3}^{2}C_{2}^1}{C_{5}^{3}}=3/5$
3. 从甲盒中取出 3 个球，其中 1 个红球，2 个白球的概率为 $\frac{C_{3}^{1}C_{2}^{2}}{C_{5}^{3}}=3/10$

所以，最终从乙盒中取到的是红球概率为 $\frac{1}{10}\times \frac{5}{6} + \frac{3}{5}\times \frac{4}{6} + \frac{3}{10}\times \frac{3}{6}=\frac{19}{30}$
:::

## 事件的独立性
> 设 A,B 是两个随机事件，如果 $P(AB)=P(A)P(B)$, 则称 A，B 相互独立。

直观来说，若 A 与 B 相互独立，则不论 A 是否发生，都不能提供 B 是否发生的信息，反之也是，这就有下面的性质
$$A,B 相互独立 \Leftrightarrow \bar A,B 相互独立 \Leftrightarrow A,\bar B 相互独立 \Leftrightarrow \bar A,\bar B 相互独立$$

> 定义：设 $A_{1},A_{2},..A_{n}$ 为 n 个随机事件，若对 $2 \leq k \leq n$，均有 $$P(A_{i1}A_{i2}...A_{ik})=\prod_{j=1}^{k}P(A_{ij})$$
则称$A_{1},A_{2},...,A_{n}$相互独立

:::tip
$P(A)=0.5, P(B)=0.4$, 求下列情况下$P(A\cup B)$
1. A 与 B 独立
2. A 与 B 不相容(互斥)
3. $A \supset B$
4. $P(AB)=0.3$

---
1. $P(A\cup B)=1-P(\bar A\bar B)=1-P(\bar A)P(\bar B)=0.7$
2. $P(A\cup B)=P(A)+P(B)=0.9$
3. $P(A\cup B)=P(A)=0.5$
4. $P(A\cup B)=P(A)+P(B)-P(AB)=0.6$
:::

## 随机变量
设随机试验的样本空间为 S，若 $$X=X(e)$$ 为定义再 S 上的实值单值函数，则称$X(e)$为随机变量，简写为$X$

1. 随机变量$X(e):S\rightarrow R$为一映射，其自变量具有随机性。
2. 随机事件可以表示为 $A=\{e:X(e)\in I\}=\{X\in I\}, I \sub R$
     * 比如：将一枚均匀的硬币抛掷 3 次，样本空间为$$S=\{正正正，正正反，正反正，正反反，反正正，反正反，反反正，反反反\}$$
若 X 表示 3 次中出现正面的次数，则
       * 随机事件 $A=\{正面出现了一次\}=\{正反反，反正反，反反正\}=\{e:X(e)=1\}=\{X=1\}$
       * 随机事件 $B=\{3次出现的情况相同\}=\{正正正，反反反\}=\{X=0或3\}$
       * 随机事件 $C=\{正面至少出现了一次\}=\{X\geq 1\}$
3. 对于$i\neq j$, 则必有$\{X=i\}\cap\{X=j\}=\phi$
4. 一般使用大写英文字母 X,Y, Z或者希腊字母 $\xi,\eta$ 等来表示随机变量。

$$常见的两类随机变量=\begin{cases}
离散型随机变量\\  
连续型随机变量
\end{cases}$$

### 离散型随机变量
若随机变量 X 的取值为有限个或可数个，则称 X 为**离散型随机变量**。

* 可数集（也成为可列集）：是指能与自然数 N 建立一一对应的集合，即其中的元素的都是可以被数到的。
  * 比如正奇数集 {1,3,5,...}
  * 整数集 {...,-2,-1,0,1,2,...}
* 不可数集是无穷集合中的一种。一个无穷集合和自然数集合之间如果不存在一一对应的关系，那么他就是一个不可数集。
  * 比如区间 [0, 1], 中间就有无限多的小数。

#### 离散型随机变量的概率分布律（简称分布律）
|X|$x_{1}$|$x_{2}$|...|$x_{k}$|...|
|---|---|---|---|---|---|
|P|$p_{1}$|$p_{2}$|...|$p_{k}$|...|

* $$分布律的内容=\begin{cases}
随机变量的所有可能取值\\
取每个可能取值相应的概率\\
\end{cases}$$
* 分布律的性质: $P_{k} \geq 0, \sum_{k=1}^{+\infty}P_{k}=1$
* 分布律的另一表示形式：$P(X=x_{k})=p_{k}, k=1,2,...$

:::tip
投掷一颗均匀的骰子，用 X 表示出现的点数，求 X 的概率分布律。

由题意可知，X 的可能取值为 1,2,3,4,5,6 且其分布律为
|X|1|2|3|4|5|6|
|---|---|---|---|---|---|---|
|P|1/6|1/6|1/6|1/6|1/6|1/6|
:::

:::tip
有一颗均匀的骰子，进行独立重复的投掷，直到出现 6 点为止停止试验。用 X 表示投掷骰子的次数，求 X 的概率分布律。

由题意知，X 的可能取值为 1,2,3,..., 用 $A_{k}=\{第 k 次掷出的点数为 6\}$
则 $A_{k}, k=1,2,3,...$ 之间相互独立，且$P\{A_{k}\}=1/6$
$P(X=1)=P(A_{1})=1/6$
$P(X=2)=P(\bar A_{1} A_{2})=5/6 \cdot 1/6$
$P(X=3)=P(\bar A_{1}\bar A_{2} A_{3})=(5/6)^2 \cdot 1/6$

故 X 的分布律为
|X|1|2|3|...|k|...|
|---|---|---|---|---|---|---|
|P|$\frac{1}{6}$|$\frac{5}{6} \cdot \frac{1}{6}$|$(\frac{5}{6})^2\cdot \frac{1}{6}$|...|$(\frac{5}{6})^k\cdot \frac{1}{6}$|...|

或写成 $P(X=k)=(\frac{5}{6})^{k-1}\cdot \frac{1}{6}, k=1,2,...,$ (几何分布)
:::

## 离散型随机变量
### 0-1 分布
若 X 的概率分布律为（随机变量只可能取 0，1 两个值）
|X|0|1|
|---|---|---|
|P|1-p|p|

其中 $0<p<1$, 就称 X 服从参数为 p 的 0-1 分布（或两点分布），记为 $X\sim 0-1(p)$[读作 X 服从参数为 p 的 0-1 分布] 或 $X\sim B(1,p)$
其分布律还可以写为 $P(X=k)=p^k(1-p)^{1-k}, k=0,1$

(X 服从**退化分布**：若$P(X=c)=1$)

#### 0-1 分布的应用
> 对于一个随机试验，若它的样本空间只包含两个元素，即$S=\{e_1,e_2\}$，我们总能在 S 上定义一个服从 0-1 分布的随机变量
> $$X=\begin{cases}0, 当 e=e_1;\\ 1, 当 e=e_2; \end{cases}$$ 来描述这个实验结果

> 一个随机试验，设 A 是一个随机事件，且$P(A)=p(0<p<1)$。若仅考虑事件 A 发生与否，就可以定义一个服从参数为 p 的 0-1 分布的随机变量
> $$X=\begin{cases}1, 若 A 发生;\\ 0, 若 A 不发生(即\bar A 发生); \end{cases}$$ 来描述这个实验结果

只有两个可能结果的试验，称为**伯努利试验**，故两点分布有时也伯努利分布。

:::tip
投掷一颗均匀的骰子，考察 6 点是否出现，用 Y 表示该实验结果，求 Y 的概率分布律
解：由题意知，令 $$Y=\begin{cases}1, 抛出的点数为 6;\\ 0, 抛出的点数不为 6.\end{cases}$$
则 Y 的分布律为
|Y|0|1|
|---|---|---|
|P|$\frac{5}{6}$|$\frac{1}{6}$|

或写成 $P=(X=k)=(\frac{1}{6})^k(\frac{5}{6}^{1-k}), k=0,1$, 即 $Y\sim 0-1(\frac{1}{6})$
事实上 Y 也可以看做是掷一次骰子，点数为 6 的次数。
:::

**实际中的例子**
* 检查产品的质量是否合格。
* 对新生婴儿的性别进行登记。
* 检查种子是否发芽。
* 考试是否通过。

设试验 E 只有两个可能的结果：$A 或 \bar A, 且P(A)=p, 0<p<1$。将 E **独立重复**进行 n 次，则称这一串重复的独立试验为 **n 重伯努利试验**。

### 二项分布
若 X 的概率分布律为 $$P\{X=k\}=C_n^kp^k(1-p)^{n-k}, k=0,1,..,n$$ 其中 $n\leq 1, 0<p<1$, 就称 X 服从参数为 $n,p$的二项分布，**记为 $X\sim B(n,p)$**

可以证明 $$1=(p+q)^n=\sum_{k=0}^{n}C_{n}^{k}p^{k}q^{n-k}, 其中 q=1-p$$

:::tip
马路上独立地乱停车 9 次，若每次不被罚的概率为 0.4.
* 用 X 表示 9 次乱停车未被罚的次数，则 $X\sim B(9,0.4)$
* 用 Y 表示 9 次乱停车被罚的次数，则 $X\sim B(9,0.6)$
:::

> 0-1 分布也可以看成是 n=1 的二项分布。

### 泊松分布
若 X 的概率分布律为 $$P(X=k)=\frac{\lambda ^{k}e^{-\lambda}}{k!}, k=0,1,2,...,$$
其中 $\lambda >0$，就称 X 服从参数为$\lambda$的泊松分布，记为 $X\sim \pi (\lambda) 或 X\sim P(\lambda)$

**泊松分布的用途**
* 某人一天内收到的微信的数量。
* 来到某公共汽车站的乘客。
* 某放射性物质放射出的粒子数量。
* 显微镜下某区域中的白血球数量。

如果某事件以固定强度$\lambda$，随机且独立地出现，该事件在单位时间内出现的次数（个数）可以看成是服从泊松分布。

二项分布与泊松分布有以下近似公式：
当n>10,P<0.1时，$$C_{n}^{k}p^{k}(1-p)^{n-k}\approx \frac{e^{-\lambda}\lambda^{k}}{k!}, 其中 \lambda=np$$
即当 n>10, p<0.1 时，二项分布$B(n,p)$可以用泊松分布$\pi(np)$来近似。

:::tip
某地区一个月内每 200 个成年人中有一个会患上某种疾病，设各人是否患病相互独立。若该地区一社区有 1000 个成年人，求某月该社区至少有 3 人患病的概率。

解：设该社区 1000 人中有 X 个人患病，则 $X\sim B(1000,p)$, 其中 p=1/200.

$P(X\geq 3)=1-P(X=0)-P(X=1)-P(X=2)$<br>
$=1-(\frac{199}{200})^{1000}-C_{1000}^{1}(\frac{1}{200})(\frac{199}{200})^{999}-C_{1000}^{2}(\frac{1}{200})^2(\frac{199}{200})^{998}=0.8760$

利用泊松分布进行近似计算，取 $\lambda=np=1000\times \frac{1}{200}=5$

$P(X\geq 3)=1-P(X=0)-P(X=1)-P(X=2)$<br>
$=1-\frac{e^{-5}}{0!}-\frac{5e^{-5}}{1!}-\frac{5^2e^{-5}}{2!}=0.8753$
:::

### 几何分布
若 X 的概率分布律为 $$P(X=k)=p(1-p)^{k-1}, k=1,2,3,...,$$
其中$0<p<1$, 称 X 服从参数为$p$的几何分布，记为$X\sim Geom(p)$ 

**几何分布的用途**

在重复多次的伯努利试验中，试验进行到某种结果出现为第一次为止，此时的试验总次数服从几何分布。

如：射击，首次击中目标时射击的次数。

## 分布函数